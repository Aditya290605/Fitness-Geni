# Profile Page â€” Detailed Overview

## Screen Architecture

The profile screen is a **single scrollable page** built as a `ConsumerWidget` (Riverpod) at:

[profile_screen.dart](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/presentation/screens/profile_screen.dart)

### Data Flow

```mermaid
graph LR
    A[Supabase Auth] --> B[currentProfileProvider]
    B --> C[Profile model]
    C -->|toUserProfile| D[UserProfile model]
    D --> E[ProfileScreen]
```

| Layer | File | Role |
|-------|------|------|
| Domain Model | [user_profile.dart](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/domain/models/user_profile.dart) | [UserProfile](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/domain/models/user_profile.dart#2-110) class with computed properties (BMI, calories, protein) |
| Adapter | [profile_adapter.dart](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/core/auth/profile_adapter.dart) | Extension [toUserProfile()](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/core/auth/profile_adapter.dart#6-19) converting Supabase [Profile](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/domain/models/user_profile.dart#2-110) â†’ [UserProfile](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/domain/models/user_profile.dart#2-110) |
| Provider | [auth_provider.dart](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/core/auth/auth_provider.dart#L30) | `currentProfileProvider` â€” exposes user's Supabase profile |
| Screen | [profile_screen.dart](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/presentation/screens/profile_screen.dart) | All UI assembled inline (no widget extraction) |

---

## UI Sections (Top to Bottom)

### 1. Header
- **"Profile"** text â€” 28px, bold, `-0.5` letter spacing

### 2. User Info Card ([_buildUserCard](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/presentation/screens/profile_screen.dart#89-161))
> [Lines 89â€“160](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/presentation/screens/profile_screen.dart#L89-L160)

| Element | Details |
|---------|---------|
| Avatar | 70px circle, green gradient (`#3D6B4A` â†’ `#5A8A6A`), shows first letter of name |
| Name | 20px bold |
| Info Pills | Three [_buildInfoPill](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/presentation/screens/profile_screen.dart#162-179) chips: **age**, **height**, **weight** â€” green tinted background |

### 3. BMI Card ([_buildBmiCard](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/presentation/screens/profile_screen.dart#180-276))
> [Lines 180â€“275](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/presentation/screens/profile_screen.dart#L180-L275)

| Element | Details |
|---------|---------|
| Label | "BMI" â€” 14px, uppercase |
| BMI Value | 56px, w900, color-coded by category |
| Unit | "kg/mÂ²" beside the value |
| Category Badge | Pill with colored background: Blue (Underweight), Green (Normal), Orange (Overweight), Red (Obese) |

### 4. Daily Nutrition Targets ([_buildNutritionSection](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/presentation/screens/profile_screen.dart#277-345))
> [Lines 277â€“343](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/presentation/screens/profile_screen.dart#L277-L343)

A 2Ã—2 grid of [_buildNutritionTile](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/presentation/screens/profile_screen.dart#346-424) cards:

| Tile | Icon | Color | Calculation |
|------|------|-------|-------------|
| Calories | ðŸ”¥ `local_fire_department` | Red `#EF4444` | Mifflin-St Jeor Ã— 1.375 activity factor |
| Protein | ðŸ’ª `fitness_center` | Green `#3D6B4A` | `weightKg Ã— 1.6` g |
| Carbs | ðŸŒ¾ `grain` | Orange `#F5A623` | `calories Ã— 0.5 / 4` g |
| Fats | ðŸ’§ `water_drop` | Purple `#8B5CF6` | `calories Ã— 0.25 / 9` g |

### 5. Goal Card ([_buildGoalCard](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/presentation/screens/profile_screen.dart#425-499))
> [Lines 425â€“497](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/presentation/screens/profile_screen.dart#L425-L497)

| Element | Details |
|---------|---------|
| Background | Full green gradient (`#3D6B4A` â†’ `#5A8A6A`) with shadow |
| Icon | Trend arrow based on goal (â†‘ gain, â†“ loss, â†’ maintain) |
| Text | "Your Goal" label + fitness goal name, both white |

### 6. Settings Section ([_buildSettingsSection](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/presentation/screens/profile_screen.dart#500-553))
> [Lines 500â€“551](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/presentation/screens/profile_screen.dart#L500-L551)

| Item | Icon | Action |
|------|------|--------|
| Edit Profile | âœï¸ `edit_outlined` | Shows "Coming Soon" snackbar |
| Change Goal | ðŸš© `flag_outlined` | Shows "Coming Soon" snackbar |
| Log Out | ðŸ”´ `logout_rounded` | Confirmation dialog â†’ cancels notifications â†’ logs out â†’ navigates to login |

---

## Design Tokens (Inline)

The screen defines its own color constants rather than using [AppColors](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/core/theme/app_colors.dart#4-40):

```dart
primaryGreen   = Color(0xFF3D6B4A)
lightGreen     = Color(0xFF5A8A6A)
accentOrange   = Color(0xFFF5A623)
background     = Color(0xFFFAFAFA)
cardBg         = Colors.white
textPrimary    = Color(0xFF1F2937)
textSecondary  = Color(0xFF6B7280)
```

---

## Unused Widget Files

The `widgets/` folder has **4 extracted widget files** that are **NOT imported** by the current [profile_screen.dart](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/presentation/screens/profile_screen.dart):

| File | Class | Description |
|------|-------|-------------|
| [identity_card.dart](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/presentation/widgets/identity_card.dart) | [IdentityCard](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/presentation/widgets/identity_card.dart#7-180) | Glassmorphism user card with avatar, age chip, height/weight row |
| [bmi_card.dart](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/presentation/widgets/bmi_card.dart) | [BmiCard](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/presentation/widgets/bmi_card.dart#7-197) | Large glassmorphism BMI display with ShaderMask gradient value |
| [goal_card.dart](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/presentation/widgets/goal_card.dart) | [GoalCard](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/presentation/widgets/goal_card.dart#6-157) | Goal + estimated daily needs (calories, protein) |
| [daily_needs_card.dart](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/presentation/widgets/daily_needs_card.dart) | [DailyNeedsCard](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/presentation/widgets/daily_needs_card.dart#6-208) | 2Ã—2 glassmorphism macro cards (calories, protein, carbs, fats) |

> [!NOTE]
> These widgets exist from a previous approach but the screen was rewritten with all UI inline in [profile_screen.dart](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/presentation/screens/profile_screen.dart). They could be cleaned up or reused in a future refactor.

---

## Logout Flow

```mermaid
sequenceDiagram
    participant U as User
    participant D as Dialog
    participant S as Screen
    participant N as MealNotificationService
    participant A as AuthService

    U->>S: Tap "Log Out"
    S->>D: Show confirmation dialog
    U->>D: Confirm
    D->>S: Show loading spinner
    S->>N: cancelAllNotifications()
    S->>N: clearState()
    S->>A: logout()
    A-->>S: Success
    S->>S: Navigate to login route
```

---

## [UserProfile](file:///Users/adityamagar/Fitness-Geni/fitness_geni/lib/features/profile/domain/models/user_profile.dart#2-110) Model â€” Computed Properties

| Property | Formula |
|----------|---------|
| `bmi` | `weightKg / (heightMÂ²)` |
| `bmiCategory` | <18.5 Underweight, <25 Normal, <30 Overweight, â‰¥30 Obese |
| `bmiDescription` | Human-readable sentence per category |
| `dailyProteinG` | `weightKg Ã— 1.6` |
| `dailyCalories` | Mifflin-St Jeor BMR Ã— 1.375 (light activity) |
| `goalExplanation` | Motivational text per goal type |
